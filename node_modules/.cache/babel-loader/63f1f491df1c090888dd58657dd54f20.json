{"ast":null,"code":"import axios from 'axios';\nlet bridgeUser = \"8SdmTqNxhLaIgHo28qv5JCeAjbsby0Hl7W9-jmKI\";\n\nconst getBridgeIP = () => {\n  let ip = axios.get('https://discovery.meethue.com').then(res => {\n    return res.data[0].internalipaddress;\n  });\n  console.log(ip);\n  let bridgeRequest = new Promise((resolve, reject) => {\n    axios.get('https://discovery.meethue.com').then(res => {\n      console.log('getting ip');\n      resolve(res.data[0].internalipaddress);\n    }).catch(err => {\n      reject(err);\n    });\n  });\n  return bridgeRequest;\n};\n\nconst connectToBridge = (ip, user) => {\n  if (user) {\n    axios.get(`http://${ip}/api/${user}`).then(res => {\n      console.log(res);\n    });\n  } else {\n    createUser(ip).then(res => {\n      axios.get(`http://${ip}/api/${res}`).then(res => {\n        console.log(res);\n      });\n    });\n  }\n};\n\nconst createUser = ip => {\n  let request = new Promise((resolve, reject) => {\n    let requestsMade = 0;\n    let bridgeRequest = setInterval(() => {\n      axios.post(`http://${ip}/api`, {\n        devicetype: \"hue-stage-wep-app\"\n      }).then(res => {\n        if (!res.data[0].error) {\n          resolve(res.data[0].success.username);\n          requestsMade += 1;\n          clearInterval(bridgeRequest);\n        } else {\n          console.log(res.data[0].error);\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n\n      if (requestsMade > 15) {\n        reject('Unable to create user');\n        clearInterval(bridgeRequest);\n      }\n    }, 2000);\n  });\n  return request;\n}; // coefficient 182.041667\n// 0 && 65535 red\n// 21845 green\n// 43690 blue\n\n\nexport const bridge = {\n  connect() {\n    getBridgeIP().then(ip => {\n      connectToBridge(ip, bridgeUser);\n    });\n  }\n\n};","map":{"version":3,"sources":["/Users/barco/Desktop/sites/tests/dnd-tests/test6/client/src/bridge.js"],"names":["axios","bridgeUser","getBridgeIP","ip","get","then","res","data","internalipaddress","console","log","bridgeRequest","Promise","resolve","reject","catch","err","connectToBridge","user","createUser","request","requestsMade","setInterval","post","devicetype","error","success","username","clearInterval","bridge","connect"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\nlet bridgeUser = \"8SdmTqNxhLaIgHo28qv5JCeAjbsby0Hl7W9-jmKI\";\n\nconst getBridgeIP = () => {\n\n    let ip = axios.get('https://discovery.meethue.com').then(res => {\n        return res.data[0].internalipaddress\n    })\n\n    console.log(ip)\n\n    let bridgeRequest = new Promise((resolve, reject) => {\n        \n        axios.get('https://discovery.meethue.com').then(res => {\n            console.log('getting ip')\n            resolve(res.data[0].internalipaddress)\n        }).catch(err => {\n            reject(err)\n        })\n    })  \n\n    return bridgeRequest;\n}\n\nconst connectToBridge = (ip, user) => {\n  if(user) {\n      axios.get(`http://${ip}/api/${user}`).then(res => {\n       console.log(res);\n      })\n  } else {\n      createUser(ip).then(res => {\n        axios.get(`http://${ip}/api/${res}`).then(res => {\n          console.log(res);\n        })\n      });\n  }\n}\n\nconst createUser = (ip) => {\n  \n  let request = new Promise((resolve, reject) => {\n\n    let requestsMade = 0;\n    \n    let bridgeRequest = setInterval(()=>{\n      axios.post(`http://${ip}/api`, {devicetype: \"hue-stage-wep-app\"})\n        .then(res => {\n          if (!res.data[0].error) {\n            resolve(res.data[0].success.username);\n            requestsMade += 1;\n            clearInterval(bridgeRequest);\n          } else {\n            console.log(res.data[0].error)\n          }\n      }).catch(err => {\n        console.log(err);\n      })\n  \n      if(requestsMade > 15) {\n        reject('Unable to create user')\n        clearInterval(bridgeRequest);\n      }\n      \n    }, 2000);\n\n  })\n\n  return request;\n\n}\n\n// coefficient 182.041667\n// 0 && 65535 red\n// 21845 green\n// 43690 blue\n\n\nexport const bridge = {\n    connect() {\n        getBridgeIP().then(ip => {\n            connectToBridge(ip, bridgeUser)\n        })\n    }\n}\n"]},"metadata":{},"sourceType":"module"}